(()=>{"use strict";var t={rotateX:45,rotateY:35,childCubes:[{position:0,translate:{x:-1,y:-1,z:1},rotate:{x:0,y:0,z:0}},{position:1,translate:{x:0,y:-1,z:1},rotate:{x:0,y:0,z:0}},{position:2,translate:{x:1,y:-1,z:1},rotate:{x:0,y:0,z:0}},{position:3,translate:{x:-1,y:-1,z:0},rotate:{x:0,y:0,z:0}},{position:4,translate:{x:0,y:-1,z:0},rotate:{x:0,y:0,z:0}},{position:5,translate:{x:1,y:-1,z:0},rotate:{x:0,y:0,z:0}},{position:6,translate:{x:-1,y:-1,z:-1},rotate:{x:0,y:0,z:0}},{position:7,translate:{x:0,y:-1,z:-1},rotate:{x:0,y:0,z:0}},{position:8,translate:{x:1,y:-1,z:-1},rotate:{x:0,y:0,z:0}},{position:9,translate:{x:-1,y:0,z:1},rotate:{x:0,y:0,z:0}},{position:10,translate:{x:0,y:0,z:1},rotate:{x:0,y:0,z:0}},{position:12,translate:{x:1,y:0,z:1},rotate:{x:0,y:0,z:0}},{position:13,translate:{x:-1,y:0,z:0},rotate:{x:0,y:0,z:0}},{position:14,translate:{x:0,y:0,z:0},rotate:{x:0,y:0,z:0}},{position:15,translate:{x:1,y:0,z:0},rotate:{x:0,y:0,z:0}},{position:16,translate:{x:-1,y:0,z:-1},rotate:{x:0,y:0,z:0}},{position:17,translate:{x:0,y:0,z:-1},rotate:{x:0,y:0,z:0}},{position:18,translate:{x:1,y:0,z:-1},rotate:{x:0,y:0,z:0}},{position:19,translate:{x:-1,y:1,z:1},rotate:{x:0,y:0,z:0}},{position:20,translate:{x:0,y:1,z:1},rotate:{x:0,y:0,z:0}},{position:21,translate:{x:1,y:1,z:1},rotate:{x:0,y:0,z:0}},{position:22,translate:{x:-1,y:1,z:0},rotate:{x:0,y:0,z:0}},{position:23,translate:{x:0,y:1,z:0},rotate:{x:0,y:0,z:0}},{position:24,translate:{x:1,y:1,z:0},rotate:{x:0,y:0,z:0}},{position:25,translate:{x:-1,y:1,z:-1},rotate:{x:0,y:0,z:0}},{position:26,translate:{x:0,y:1,z:-1},rotate:{x:0,y:0,z:0}},{position:27,translate:{x:1,y:1,z:-1},rotate:{x:0,y:0,z:0}}]};function n(t){return t*(180/Math.PI)}function e(t){return t*(Math.PI/180)}function r(t,n,e){return{x:Math.sin(t/2)*Math.cos(n/2)*Math.cos(e/2)-Math.cos(t/2)*Math.sin(n/2)*Math.sin(e/2),y:Math.cos(t/2)*Math.sin(n/2)*Math.cos(e/2)+Math.sin(t/2)*Math.cos(n/2)*Math.sin(e/2),z:Math.cos(t/2)*Math.cos(n/2)*Math.sin(e/2)-Math.sin(t/2)*Math.sin(n/2)*Math.cos(e/2),w:Math.cos(t/2)*Math.cos(n/2)*Math.cos(e/2)+Math.sin(t/2)*Math.sin(n/2)*Math.sin(e/2)}}var o=function(t){return t<9},a=function(t){return t%9<3},i=function(t){return(t+1)%3==0},c=function(t){return t%3==0},u=function(t){return t%9>5},s=function(t){return t>17},l=function(t){return(t-1)%3==0},f=function(t){return t>8&&t<18},y=function(t){var n=t%9;return n>=3&&n<=5};function d(t){var e={x:Math.atan2(t[9],t[10]),y:Math.atan2(-t[8],Math.sqrt(Math.pow(t[9],2)+Math.pow(t[10],2))),z:Math.atan2(t[4],t[0])};return{x:n(e.x),y:n(e.y),z:n(e.z)}}function h(t,n){var e=n.x,r=n.y,o=n.z,a=n.w,i=e+e,c=r+r,u=o+o,s=e*i,l=e*c,f=e*u,y=r*c,d=r*u,h=o*u,v=a*i,p=a*c,g=a*u;return t[0]=1-(y+h),t[1]=l+g,t[2]=f-p,t[3]=0,t[4]=l-g,t[5]=1-(s+h),t[6]=d+v,t[7]=0,t[8]=f+p,t[9]=d-v,t[10]=1-(s+y),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function v(t,n,e){var r=n[0],o=n[1],a=n[2],i=n[3],c=n[4],u=n[5],s=n[6],l=n[7],f=n[8],y=n[9],d=n[10],h=n[11],v=n[12],p=n[13],g=n[14],b=n[15],m=e[0],x=e[1],S=e[2],z=e[3];return t[0]=m*r+x*c+S*f+z*v,t[1]=m*o+x*u+S*y+z*p,t[2]=m*a+x*s+S*d+z*g,t[3]=m*i+x*l+S*h+z*b,m=e[4],x=e[5],S=e[6],z=e[7],t[4]=m*r+x*c+S*f+z*v,t[5]=m*o+x*u+S*y+z*p,t[6]=m*a+x*s+S*d+z*g,t[7]=m*i+x*l+S*h+z*b,m=e[8],x=e[9],S=e[10],z=e[11],t[8]=m*r+x*c+S*f+z*v,t[9]=m*o+x*u+S*y+z*p,t[10]=m*a+x*s+S*d+z*g,t[11]=m*i+x*l+S*h+z*b,m=e[12],x=e[13],S=e[14],z=e[15],t[12]=m*r+x*c+S*f+z*v,t[13]=m*o+x*u+S*y+z*p,t[14]=m*a+x*s+S*d+z*g,t[15]=m*i+x*l+S*h+z*b,t}function p(){return new Array(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}var g=function(t){return new Float32Array(new DOMMatrixReadOnly(getComputedStyle(t).transform).toFloat32Array())};function b(t,n){return Math.floor(Math.random()*(n-t+1))+t}function m(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}window.solve=function(){(function(){console.log("Solving Cross");var t="F' L' U' L U F".split(" ");Lt(t)})(),console.log("Solving F2L"),console.log("Solving OLL"),console.log("Solving PLL")};var x=document.createElement("canvas");x.width=x.height=1;var S=x.getContext("2d"),z=function(t){S.clearRect(0,0,1,1),S.fillStyle="#000",S.fillStyle=t;var n,e=S.fillStyle;if(S.fillStyle="#fff",S.fillStyle=t,e===S.fillStyle)return S.fillRect(0,0,1,1),function(t){if(Array.isArray(t))return m(t)}(n=S.getImageData(0,0,1,1).data)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,n){if(t){if("string"==typeof t)return m(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?m(t,n):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},M=null,w=Array.from(document.querySelectorAll("dialog")),L=function(t){return w.find((function(n){return n.dataset.id===t}))},E=function(t,n){t.addEventListener("touchstart",k,!1),t.addEventListener("mousedown",k,!1),t.addEventListener("touchend",n,!1),t.addEventListener("mouseup",n,!1)},k=function(t){return t.stopPropagation(),t.preventDefault(),!1},A=document.querySelector(":root"),q=function(t,n){A.style.setProperty(t,n)},I="colors-settings",_=L("settings"),D=_.querySelector(".close-dialog"),U=_.querySelectorAll(".input-color"),X=_.querySelector(".dialog-settings-btn-save"),P=_.querySelector(".dialog-settings-btn-reset"),Y={},F=function(){M==="settings"&&(L("settings").close(),M=null)},O=function(){var t={};return U.forEach((function(n){var e=R(n.id);q(e,n.value),t[e]=n.value})),function(t){var n,e;n=I,e=t,localStorage.setItem(n,JSON.stringify(e))}(t),F(),k(event)},R=function(t){return"--".concat(t,"0")},T=function(){return U.forEach((function(t){var n=R(t.id),e=Y[n];q(n,e),t.value=e})),k(event)},C=function(t){var n=document.querySelector(".btn_scramble"),e=document.querySelector(".btn_reset");t?(j(n),Z(e)):(j(e),Z(n))},Z=function(t){t.classList.contains("hide")||t.classList.add("hide")},j=function(t){t.classList.contains("hide")&&t.classList.remove("hide")},B=function(){var t;t="settings",M||(L(t).showModal(),M=t)},W=function(t){return nt(),k(t)},N=function(t){return gt(t),k(t)},J=function(t){return bt(t.target.dataset.id),k(t)},G=function(t){return wt(t),k(t)};function H(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var $=[],K=[],V=0,Q=!1,tt=!1,nt=function(){at()||tt||rt()},et=function(){return document.querySelector(".rubiks_cube")},rt=function(){document.querySelectorAll(".cube_container").forEach((function(t,n){ut(t.dataset.posInit,t),lt(0,0,0,t,n)})),V=0,C(!0)},ot=function(t){return $[t].cube},at=function(){return V<0&&(V=0),0!=V},it=function(){0==(V-=1)&&(Q=!1),0==K.length&&0==V&&0==Q&&C(dt()),ct()},ct=function(){K.length>0&&!at()&&!tt&&bt(K[0])},ut=function(t,n){n.dataset.pos=t,$[t]={cube:n,pos:t}},st=function(n,e,r){n=Math.abs(n)>90?90*Math.sign(n):n,t.rotateX=n,t.rotateY=e,r.style.transform="rotateX("+n+"deg) rotateY("+e+"deg) translateZ(0)"},lt=function(t,n,o,a,i){V+=1;var c,u,s,l,f,y,d,h,v,p,b,m,x,S,z,M,w,L,E,k,A,q,I,_,D,U,X,P=g(a);c=P,s=(u=r(e(t),e(n),e(o))).x,E=1-((x=(l=u.y)*(h=l+l))+(z=(f=u.z)*(v=f+f))),k=(b=s*h)-(L=(y=u.w)*v),A=(m=s*v)+(w=y*h),q=b+L,I=1-((p=s*(d=s+s))+z),_=(S=l*v)-(M=y*d),D=m-w,U=S+M,X=1-(p+x),c[0]=E,c[1]=k,c[2]=A,c[3]=0,c[4]=q,c[5]=I,c[6]=_,c[7]=0,c[8]=D,c[9]=U,c[10]=X,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,yt(a,P)},ft=function(t,n,o,a){(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&(V+=1);var i=g(a),c=r(e(t),e(n),e(o)),u=h(p(),c),s=p();return s=v(s,u,i),yt(a,s),s},yt=function(t,n){var e=n[0],r=n[1],o=n[2],a=n[3],i=n[4],c=n[5],u=n[6],s=n[7],l=n[8],f=n[9],y=n[10],d=n[11],h=n[12],v=n[13],p=n[14],g=n[15];t.style.transform="matrix3d(".concat(e,", ").concat(r,", ").concat(o,", ").concat(a,", ").concat(i,", ").concat(c,", ").concat(u,", ").concat(s,", ").concat(l,", ").concat(f,", ").concat(y,", ").concat(d,", ").concat(h,", ").concat(v,", ").concat(p,", ").concat(g,")")};function dt(){for(var t=!0,n=$[0].cube,o=d(g(n)),a=r(e(o.x),e(o.y),e(o.z)),i=h(p(),a),c=0;c<$.length;c++){var u=$[c],s=g(u.cube),l=d(v(p(),s,i));if(0!=Math.round(l.x)||0!=Math.round(l.y)||0!=Math.round(l.z)){t=!1;break}}return t}window.test=function(){return console.log(dt())};var ht=[2,5,8,1,-1,7,0,3,6],vt=[6,3,0,7,-1,1,8,5,2],pt=function(t,n){for(var e=function(t){return 1==t?vt:ht}(n),r=[],o=0;o<t.length;o++)if(4!=o){var a=t[o],i=e[o];r.unshift({index:o,pos:t[i].pos})}for(var c=0,u=r;c<u.length;c++){var s=u[c];a=t[s.index],ut(s.pos,a.cube)}},gt=function(){var t=document.querySelector(".rubiks_cube");st(-35,-45,t)},bt=function(t){if(!tt)if(at())K.push(t);else{var n=1;if(t.length>0)if("'"===t[1])n=-1;else if("2"===t[1]){var e=K.shift();K.unshift(t[0]),K.unshift(e)}var r=t[0];"X"===r||"Y"===r||"Z"===r?xt(t,n):mt(t,n),K.shift()}},mt=function(t,n){var e=Mt(t,n),r=e.newPosDico,o=e.signToUpdatePos;pt(r,o),Q=!0},xt=function(t,n){zt(t,n).forEach((function(t){var n=t.newPosDico,e=t.signToUpdatePos;pt(n,e)}))},St=function(t,n,e,r){var o=[],a=function(t){var n=[];return $.forEach((function(e,r){t(r)&&n.push({pos:r,cube:e.cube})})),n}(t);return console.log(a.length),a.forEach((function(t){ft(n,e,r,t.cube),o.push(t)})),o},zt=function(t,n){var e=[];switch(t[0]){case"X":e.push(Mt("R",n)),e.push(Mt("M'",-n)),e.push(Mt("L'",-n));break;case"Y":e.push(Mt("U",n)),e.push(Mt("E",n)),e.push(Mt("D'",-n));break;case"Z":e.push(Mt("F",n)),e.push(Mt("S",n)),e.push(Mt("B'",-n))}return e},Mt=function(t,n){var e=[];switch(t[0]){case"U":e=St(o,0,-90*n,0);break;case"D":e=St(s,0,90*n,0),n*=-1;break;case"F":e=St(a,0,0,90*n),n*=-1;break;case"B":e=St(u,0,0,-90*n);break;case"R":e=St(i,90*n,0,0),n*=-1;break;case"L":e=St(c,-90*n,0,0);break;case"M":e=St(l,-90*n,0,0);break;case"E":e=St(f,0,-90*n,0);break;case"S":e=St(y,0,0,90*n),n*=-1}return{newPosDico:e,signToUpdatePos:n}},wt=function(){if(!tt){var t=function(t){for(var n=["U","D","L","R","F","B","M","E","S"],e=["","'","2"],r=[],o=0;o<21;o++){var a=n[b(0,n.length-1)],i=e[b(0,e.length-1)];r.push(a+i)}return console.log(r),r}();Lt(t)}},Lt=function(t){var n,e=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return H(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?H(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==e.return||e.return()}finally{if(c)throw a}}}}(t);try{for(e.s();!(n=e.n()).done;){var r=n.value;K.push(r)}}catch(t){e.e(t)}finally{e.f()}ct()};window.exportCubePos=function(){console.log(JSON.stringify($.map((function(t){return t.cube.dataset.posInit}))))};var Et=[];Et.ArrowUp="UP",Et.ArrowLeft="LEFT",Et.ArrowDown="DOWN",Et.ArrowRight="RIGHT",Et.r="R",Et.d="D",Et.u="U",Et.l="L",Et.b="B",Et.f="F",Et.R="R",Et.D="D",Et.U="U",Et.L="L",Et.B="B",Et.F="F",Et.m="M",Et.e="E",Et.s="S",Et.M="M",Et.E="E",Et.S="S",Et.x="X",Et.X="X",Et.y="Y",Et.Y="Y",Et.z="Z",Et.Z="Z";var kt,At;"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/service-worker.js").then((function(t){console.log("SW registered: ",t)})).catch((function(t){console.log("SW registration failed: ",t)}))})),E(D,F),E(P,T),E(X,O),U.forEach((function(t){var n,e,r,o=R(t.id),a=(n=o,getComputedStyle(A).getPropertyValue(n));console.log(o,a),Y[o]=(e=z(a),r=(256|e[0]).toString(16).slice(1)+(256|e[1]).toString(16).slice(1)+(256|e[2]).toString(16).slice(1),console.log(r),"#"+r)})),(At=function(t){try{if(!localStorage.getItem(t))return;return JSON.parse(localStorage.getItem(t))}catch(t){console.error("failed to parse localStorage")}}(I))&&U.forEach((function(t){var n=R(t.id);At[n]&&q(n,At[n])})),function(){var n,e,r,o,a,i=document.querySelector(".scene_container"),c=document.querySelector(".rubiks_cube"),u=document.querySelectorAll(".cube_container_position"),s=void 0,l=-1,f=!1,y=[],h=0,v=0,p=[],b=!1;function m(n){if(n.target===i||i.contains(n.target)){if(f=!0,!at())for(var e=0;e<u.length;e++)if(n.target===ot(e)||u[e].contains(n.target)){s=ot(e),l=s.dataset.pos;break}s&&-1!=l&&at(),!1,et().classList.add("drag-cube"),h=t.rotateY,v=-t.rotateX,"touchstart"===n.type?(r=n.touches[0].clientX-h,o=n.touches[0].clientY-v):(r=n.clientX-h,o=n.clientY-v)}}function x(t){b=!1,et().classList.remove("drag-line"),tt&&(tt=!1),et().classList.remove("drag-cube"),tt&&(tt=!1),function(){if(a){var t=y.find((function(t){return a==t.axis})).line;p=t.forEach((function(t,n){var e=ot(t),r=d(p[n]);lt(r.x,r.y,r.z,e,t)}))}}(),a=void 0,r=n,o=e,p=[],f=!1,s=void 0,l=-1,y=[]}function S(t){if(f){if(t.preventDefault(),"touchmove"===t.type?(n=t.touches[0].clientX-r,e=t.touches[0].clientY-o):(n=t.clientX-r,e=t.clientY-o),h=n,v=e,!b)return void st(-e,n,c);if(console.log(n,e),a?y.find((function(t){return t.axis==a})).line:(Math.abs(n)>6||Math.abs(e)>6)&&(Math.abs(n)-Math.abs(e)<7?a="Z":Math.abs(n)>Math.abs(e)?a="X":Math.abs(n)<Math.abs(e)&&(a="Y"),a&&(S=y.find((function(t){return a==t.axis})).line,p=S.map((function(t){var n=ot(t);return g(n)})))),!a)return;console.log("AXIS:",a);var i=y.find((function(t){return a==t.axis})).line,u=-e,s=n,l=[0,0,0],d=0;"X"==a?(l[1]=1,d=Math.min(Math.max(-2.2,s),2.2)):"Y"==a?(l[0]=1,d=Math.min(Math.max(-2.2,s),2.2)):"Z"==a&&(l[0]=1,d=Math.min(Math.max(-2.2,u),2.2));for(var m=0;m<i.length;m++){var x=i[m];ft(d*l[0],d*l[1],d*l[2],ot(x),!1)}}var S}i.addEventListener("touchstart",m,!1),i.addEventListener("touchend",x,!1),i.addEventListener("touchmove",S,!1),i.addEventListener("mousedown",m,!1),i.addEventListener("mouseup",x,!1),i.addEventListener("mousemove",S,!1)}(),window.addEventListener("keydown",(function(t){var n=t.key;if(Et[n])switch(Et[n]){case"UP":var e=document.querySelector(".rubiks_cube");ft(25,0,0,e);break;case"DOWN":e=document.querySelector(".rubiks_cube"),ft(-25,0,0,e);break;case"RIGHT":e=document.querySelector(".rubiks_cube"),ft(0,25,0,e);break;case"LEFT":e=document.querySelector(".rubiks_cube"),ft(0,-25,0,e);break;default:bt(Et[n]+(function(t){return t.shiftKey}(t)?"'":""))}})),document.querySelectorAll(".btn_move").forEach((function(t){E(t,J)})),kt=document.querySelector(".btn_scramble"),E(kt,G),function(){var t=document.querySelector(".btn_center");E(t,N)}(),function(){var t=document.querySelector(".btn_reset");E(t,W)}(),function(){var t=document.querySelector(".helper-icon-settings");E(t,B)}(),document.querySelectorAll(".cube_container").forEach((function(t,n){ut(t.dataset.posInit,t),lt(0,0,0,t,n),t.addEventListener("transitionend",it)})),gt()})();